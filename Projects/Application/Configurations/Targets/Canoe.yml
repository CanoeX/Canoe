targets:
  Canoe:
    platform: iOS
    type: application
    configFiles:
      Development Debug: Configurations/Configs/Development.xcconfig
      Development Release: Configurations/Configs/Development.xcconfig
      Production Debug: Configurations/Configs/Production.xcconfig
      Production Release: Configurations/Configs/Production.xcconfig
    sources:
      - Sources
    dependencies:
      - framework: ../../Rome/Crashlytics.framework
        embed: false
      - framework: ../../Rome/Fabric.framework
        embed: false
      - framework: ../../Rome/ReactorKit.framework
      - framework: ../../Rome/Rswift.framework
      - framework: ../../Rome/RxCocoa.framework
      - framework: ../../Rome/RxSwift.framework
      - framework: ../../Rome/RxAtomic.framework
    scheme:
      testTargets:
        - CanoeTests
        - CanoeUITests
      configVariants:
        - Development
        - Production
      gatherCoverageData: true
    preBuildScripts:
      - name: R.swift
        script: |
          "../../Scripts/rswift" generate "$SRCROOT/Sources/Generated/R.generated.swift"
        inputFiles:
          - $TEMP_DIR/rswift-lastrun
        outputFiles:
          - $SRCROOT/Sources/Generated/R.generated.swift
      - name: Swiftlint autocorrect
        script: cd ../.. && swiftlint autocorrect
    postCompileScripts:
      - name: Swiftlint
        script: cd ../.. && swiftlint
      - name: Copy paste detector
        script: cd ../.. && Scripts/cpd
    postbuildScripts:
      - name: Strip Unused Architectures from Frameworks
        path: ../../Scripts/strip-frameworks.sh
        runOnlyWhenInstalling: true
    